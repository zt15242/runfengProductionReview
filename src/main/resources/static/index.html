<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>关联询价</title>
    <!--引入 element-ui 的样式，-->
    <link rel="stylesheet" href="css/index.css">
    <!-- 必须先引入vue，  后使用element-ui -->
    <script src="js/vue.js"></script>
    <!-- 引入element 的组件库-->
    <script src="js/index.js"></script>
    <script type="text/javascript" src="js/NeoLappSdk.js"></script>
</head>
<body>
<div class="container" id="app">
    <div class="block">
        <el-row style="margin-bottom: 20px;">
            <span>基建项目：</span>
            <span>医院名：<el-link type="primary">主要链接</el-link></span>
        </el-row>
        <el-form :inline="true" :model="opportunity" class="demo-form-inline">
            <el-form-item label="询价编码/名称">
              <el-input v-model="opportunity.like"></el-input>
            </el-form-item>
            <el-form-item>
              <el-button type="primary" @click="onSubmit">查询</el-button>
              <el-button type="primary" @click="onSubmit">保存</el-button>
            </el-form-item>
          </el-form>
    </div>
</div>
</body>
<script>

    new Vue({
        el: '#app',
        data: function() {
            return {
                opportunity:{
                    like:''
                },
                
            }
        },
        mounted() {
           this.test();
        },
        methods :{
            test(){
                const belongId = this.getBelongId();
                console.log("id:"+belongId);
                lapp.connection.invoke({
                    url:'/rest/data/v2.0/xobjects/Infrastructure_Project__c/'+belongId,
                    method:'get',
                    contentType:'application/json'
                }).then(
                    res => {
                        console.log(res);
                        const {OCSM_Hospita__c} = res.data.data;
                        console.log(OCSM_Hospita__c);
                        if (OCSM_Hospita__c == null){
                            // window.alert("");
                            this.$message({
                                showClose: true,
                                message: '请先关联客户哦~~',
                                type: 'error'
                            });
                            return null;
                        }
                    },
                    err => {
                        console.log(err)
                    }
                )
            },
            getBelongId() {
                const url = new URL(window.location.href);
                const searchParams = new URLSearchParams(url.search);
                return searchParams.get('recordId');
            }
        }
    })
</script>
</html>